webpackJsonp([36],{"8UgB":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("3cXf"),i=a.n(n),s=a("aA9S"),o=a.n(s),r=a("Q/W4"),d=a("0+Q0"),c=a("zN9r"),l=a("GUev"),p=a("+EaS"),x=a("4PKW"),m=a("myXI"),b=a("qTPs"),u=a("AQir"),v=(r.a,d.a,c.a,l.a,p.a,x.a,{components:{Group:r.a,Cell:d.a,Marquee:c.a,MarqueeItem:l.a,Flexbox:p.a,FlexboxItem:x.a},data:function(){return{code:void 0,msgArray:["欢迎您停靠本停车场","感谢使用"],params:{departmentName:"正在查询..",plate:"正在查询..",inTime:"正在查询..",queryTime:"正在查询..",duration:"正在查询..",price:"正在查询.."},isShow:!1,disabled:!1,btnText:"支付",formatterTime:u.a}},mounted:function(){this.getAppId()},methods:{getAppId:function(){var t=this;if(window.location.href.indexOf("?")>-1){var e={authCode:Object(u.d)("code"),payType:5};Object(b.c)(m.H,e).then(function(e){t.params.authCode=e.data,t.getOrder()}).catch(function(){})}},getOrder:function(){var t=this,e=this;if(window.location.href.indexOf("?")>-1){var a={departmentId:Object(u.d)("d"),outChannelId:Object(u.d)("c"),plate:decodeURIComponent(Object(u.d)("p")),payScene:Number(Object(u.d)("s")),payType:5,authCode:this.params.authCode};Object(b.d)(m.W,a).then(function(n){if(1===n.code)if(e.params=o()(a,n.data),0===e.params.price||e.params.plate.length<=6){window.confirm("当前应付金额为0元，请退出！");window.WeixinJSBridge&&window.WeixinJSBridge.invoke("closeWindow",{},function(t){})}else e.isShow=!0;else e.isShow=!1,t.$vux.toast.text(n.message,"bottom")}).catch(function(){e.isShow=!1,t.$vux.toast.text("服务器连接失败","bottom")})}else e.isShow=!1,this.$vux.toast.text("链接返回错误!","bottom"),window.WeixinJSBridge&&window.WeixinJSBridge.invoke("closeWindow",{},function(t){})},goPay:function(){var t=this,e=this;e.disabled||(e.btnText="请求中...",e.disabled=!0,Object(b.d)(m.Y,this.params).then(function(t){e.btnText="支付中...",e.disabled=!0;var a=t.data;void 0===window.WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",e.onBridgeReady(a),!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",e.onBridgeReady(a)),document.attachEvent("onWeixinJSBridgeReady",e.onBridgeReady(a))):e.onBridgeReady(a)}).catch(function(a){console.log(a),t.$vux.toast.text("服务器错误，请稍后再试!","bottom"),e.btnText="支付",e.disabled=!1}))},onBridgeReady:function(t){var e=this,a=""+t.timeStamp;window.WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:t.appId,timeStamp:a,nonceStr:t.nonceStr,package:t.pack,signType:t.signType,paySign:t.paySign},function(t){if("get_brand_wcpay_request:ok"===t.err_msg){e.btnText="支付成功";var a=i()(o()(e.params,{payTime:e.formatterTime(new Date)}));e.$router.push({path:"/CYWeChatPay/tip/",query:{paramas:""+a}})}else e.btnText="支付已取消",e.disabled=!1})}}}),f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("group",[a("cell",{attrs:{title:"公告"}},[a("marquee",t._l(t.msgArray,function(e){return a("marquee-item",{key:e},[t._v(t._s(e))])}),1)],1)],1),t._v(" "),a("div",{staticClass:"box"},[a("div",{staticClass:"box-title"},[a("div",{staticClass:"box-plate"},[t._v(t._s(t.params.plate))]),t._v(" "),a("div",{staticClass:"box-departmentInfo"},[t._v(t._s(t.params.departmentName))])]),t._v(" "),a("div",{staticClass:"box-content"},[a("flexbox",{staticClass:"box-content-card"},[a("flexbox-item",{staticClass:"box-content-card-left",attrs:{span:1/3}},[t._v("入场时间:")]),t._v(" "),a("flexbox-item",{staticClass:"box-content-card-right",attrs:{span:2/3}},[t._v(t._s(t.params.inTime))])],1),t._v(" "),a("flexbox",{staticClass:"box-content-card"},[a("flexbox-item",{staticClass:"box-content-card-left",attrs:{span:1/3}},[t._v("查询时间:")]),t._v(" "),a("flexbox-item",{staticClass:"box-content-card-right",attrs:{span:2/3}},[t._v(t._s(t.params.queryTime))])],1),t._v(" "),a("flexbox",{staticClass:"box-content-card"},[a("flexbox-item",{staticClass:"box-content-card-left",attrs:{span:1/3}},[t._v("停车时长:")]),t._v(" "),a("flexbox-item",{staticClass:"box-content-card-right",attrs:{span:2/3}},[t._v(t._s(t.params.duration))])],1),t._v(" "),a("flexbox",{staticClass:"box-content-card"},[a("flexbox-item",{staticClass:"box-content-card-left",attrs:{span:1/3}},[t._v("支付金额:")]),t._v(" "),a("flexbox-item",{staticClass:"box-content-card-right",attrs:{span:2/3}},[a("span",{staticClass:"money"},[t._v(t._s("正在查询.."==t.params.price?"正在查询..":t.params.price))])])],1)],1)]),t._v(" "),t.isShow?a("div",{staticClass:"pay",attrs:{disabled:t.disabled},on:{click:t.goPay}},[t._v(t._s(t.btnText))]):t._e()],1)},staticRenderFns:[]};var h=a("C7Lr")(v,f,!1,function(t){a("xfCg")},"data-v-761dcbd6",null);e.default=h.exports},xfCg:function(t,e){}});